Code taken from https://github.com/Externalizable/bongo.cat